<div ng-controller="ForumPageCtrl" ng-init="initForumCtrl()" ng-cloak>

    <div ng-if="isForumLoaded">

        <div ng-controller="HeaderCtrl"
             ng-init="initHeaderCtrl(name, '#/')"
             header-template>
        </div>

        <style>
            .addTopicBox span.subjectTooLong
            {
                color: red;
            }

            .addTopicBox span.subjectLengthOk
            {
                color: green;
            }

            .addTopicBox input.subjectTooLong
            {
                background-color: red;
            }

            .addTopicBox img
            {
                max-width: 650px;
                max-height: 350px;
            }
        </style>

        <div ng-controller="AddTopicCtrl"
             ng-init="initAddTopicCtrl()"
             class="addTopicBox"
             ng-cloak>

            <button ng-if="collapsed" class="btn btn-info" ng-click="showButtonClicked()">Create Topic</button>

            <div ng-if="!collapsed">
                <div class="form-group">
                    <input type="text"
                           placeholder="Topic subject"
                           style="width: 100%; padding: 5px;"
                           ng-model="newSubject.value"
                           ng-class="newSubject.value.length > subjectMaxLength ? 'subjectTooLong' : 'subjectLengthOk'"/>
                </div>
                <div class="form-group">
                    <div placeholder="Topic post"
                         style="width: 100%;"
                         ng-model="newText.value"
                         text-angular
                         ta-toolbar="[['p','pre','quote'],['bold','italics','underline'],['ul','ol'],['undo','redo'],['insertLink','insertImage']]">
                    </div>
                </div>
                <button class="btn btn-success" ng-click="addButtonClicked(newSubject.value)">Create Topic</button>
                <button class="btn btn-warning" ng-click="cancelButtonClicked()">Cancel</button>
            </div>

        </div>

        <br/>

        <div ng-repeat="topic in topics">

            <div ng-controller="TopicListCtrl"
                 ng-init="initTopicListCtrl(topic)"
                 ng-cloak
                 class="well">

                <div class="postContainer">
                    <div>
                        <span class="message">
                            <a href="#/{{ forumId }}/topics/{{ topic.topicId }}">{{ topic.subject }}</a>
                        </span>
                    </div>
                    <div>
                        <span>Created by {{ topic.creator }} on
                            <span popover="{{ topic.createDate | date: 'EEE MMM d, y' }} at {{ topic.createDate | date: 'H:mm' }}"
                                  popover-trigger="mouseenter"
                                  popover-append-to-body="true"
                                  popover-placement="top">
                                {{ topic.createDate | date: 'MMM d' }}
                            </span>
                        </span>
                    </div>
                </div>

            </div>

        </div>

    </div>

</div>